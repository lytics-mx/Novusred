<odoo>
    <template id="report_invoice_move_payment_block" inherit_id="account.report_invoice_document">
        <!-- 1) Insertar una copia del bloque justo después de la tabla de líneas -->
        <xpath expr="//table[@name='invoice_line_table']" position="after">
            <div id="payment_term_moved" class="clearfix overflow-auto">
                <div class="justify-text">
                    <p t-if="not is_html_empty(o.fiscal_position_id.note)" name="note" class="mb-2">
                        <span t-field="o.fiscal_position_id.note"/>
                    </p>
                </div>
                <div class="justify-text">
                    <p t-if="not is_html_empty(o.taxes_legal_notes)" name="taxes_legal_notes" class="mb-2">
                        <span t-field="o.taxes_legal_notes"/>
                    </p>
                </div>
                <t t-set="payment_term_details" t-value="o.payment_term_details"/>
                <div class="mb-3">
                    <span t-if="o.invoice_payment_term_id.note" t-field="o.invoice_payment_term_id.note" name="payment_term">Payment within 30 calendar day</span><br/>
                    <t t-if="o.invoice_payment_term_id.display_on_invoice and payment_term_details">
                        <div t-if="o.show_payment_term_details" id="total_payment_term_details_table" class="row">
                            <div t-attf-class="#{'col-10' if report_type != 'html' else 'col-sm-10 col-md-9'}">
                                <t t-if="o._is_eligible_for_early_payment_discount(o.currency_id,o.invoice_date)">
                                    <td>
                                        <span t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" t-out="o.invoice_payment_term_id._get_amount_due_after_discount(o.amount_total, o.amount_tax)"/>
                                        due if paid before
                                        <span t-out="o.invoice_payment_term_id._get_last_discount_date_formatted(o.invoice_date)"/>
                                    </td>
                                </t>
                                <t t-if="len(payment_term_details) &gt; 1" t-foreach="payment_term_details" t-as="term">
                                    <div>
                                        <span t-out="term_index + 1">1</span> - Installment of
                                        <t t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" t-out="term.get('amount')" class="text-end"/>
                                        <span> due on </span>
                                        <t t-out="term.get('date')" class="text-start"/>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </t>
                </div>

                <div class="mb-3" t-if="o.move_type in ('out_invoice', 'in_refund') and o.payment_reference">
                    <p name="payment_communication">
                        Payment Communication: <span class="fw-bold" t-field="o.payment_reference"/>
                        <t t-if="o.partner_bank_id">
                            <br/> on this account: <span t-field="o.partner_bank_id" class="fw-bold"/>
                        </t>
                    </p>
                </div>

                <t t-set="show_qr" t-value="o.display_qr_code and o.amount_residual &gt; 0"/>
                <div t-if="not show_qr" name="qr_code_placeholder" class="oe_structure"/>
                <div id="qrcode" class="d-flex mb-3 avoid-page-break-inside" t-else="">
                    <div class="qrcode me-3" id="qrcode_image">
                        <t t-set="qr_code_url" t-value="o._generate_qr_code(silent_errors=True)"/>
                        <p t-if="qr_code_url" class="position-relative mb-0">
                            <img t-att-src="qr_code_url"/>
                            <img src="/account/static/src/img/Odoo_logo_O.svg" id="qrcode_odoo_logo" class="top-50 start-50 position-absolute bg-white border border-white border-3 rounded-circle"/>
                        </p>
                    </div>
                    <div class="d-inline text-muted lh-sm fst-italic" id="qrcode_info" t-if="qr_code_url">
                        <p>Scan this QR Code with<br/>your banking application</p>
                    </div>
                </div>

                <div class="text-muted mb-3" t-attf-style="#{'text-align:justify;text-justify:inter-word;' if o.company_id.terms_type != 'html' else ''}" t-if="not is_html_empty(o.narration)" name="comment">
                    <span t-field="o.narration"/>
                </div>
            </div>
        </xpath>

        <!-- 2) Eliminar el bloque original para evitar duplicados -->
        <xpath expr="//div[@id='payment_term']" position="replace"/>

    </template>
</odoo>