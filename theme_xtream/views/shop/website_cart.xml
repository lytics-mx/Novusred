<odoo>
  <template id="website_cart_buy_now" inherit_id="website_sale.cart">
    <xpath expr="." position="replace">
      <t t-call="website.layout">
        <div id="wrap" class="oe_website_sale" style="background:#ededed;min-height:100vh;">
          <div class="container py-5">
            <div class="card shadow-sm rounded" style="max-width:900px;margin:auto;background:#fff;">
              <div class="card-body p-0" style="background-color:#fff;">
                <div class="px-4 pt-4 pb-2">
                  <ul class="nav nav-tabs border-0">
                    <li class="nav-item">
                      <button class="nav-link active" id="cart-tab-btn" data-tab="cart-tab">
                        Carrito (<t t-esc="len(website_sale_order.order_line)"/>)
                      </button>
                    </li>
                    <li class="nav-item">
                      <button class="nav-link" id="saved-tab-btn" data-tab="saved-tab">
                        Guardados (<t t-esc="len(saved_items or [])"/>)
                      </button>
                    </li>
                  </ul>
                </div>
                <hr class="my-0"/>

                <!-- Contenido del carrito -->
                <div id="cart-tab-content" class="tab-content">
                  <t t-if="website_sale_order and website_sale_order.order_line">
                    <t t-foreach="website_sale_order.order_line" t-as="line">
                      <div class="row align-items-center px-4 py-3 border-bottom">
                        <div class="col-8">
                          <t t-esc="line.product_id.display_name"/>
                        </div>
                        <div class="col-4 text-end">
                          <a t-att-href="'/shop/cart/save_for_later?line_id=%d&amp;product_id=%d' % (line.id, line.product_id.id)"
                             class="btn btn-sm btn-secondary">Guardar para después</a>
                        </div>
                      </div>
                    </t>
                  </t>
                  <t t-else="">
                    <div class="p-5 text-center text-muted">
                      <p>Tu carrito está vacío</p>
                    </div>
                  </t>
                </div>

                <!-- Contenido de guardados -->
                <div id="saved-tab-content" class="tab-content d-none">
                    <t t-if="saved_items and len(saved_items) > 0">
                        <t t-foreach="saved_items" t-as="item">
                            <div class="row align-items-center px-4 py-3 border-bottom">
                                <div class="col-8">
                                    <t t-esc="item['name']"/>
                                </div>
                                <div class="col-4 text-end">
                                    <span class="text-muted">$<t t-esc="'%.2f' % item['price']"/></span>
                                </div>
                            </div>
                        </t>
                    </t>
                    <t t-else="">
                        <div class="p-5 text-center text-muted">
                            <p>No tienes productos guardados</p>
                        </div>
                    </t>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script type="text/javascript">
          document.addEventListener('DOMContentLoaded', function() {
            const cartTabBtn = document.getElementById('cart-tab-btn');
            const savedTabBtn = document.getElementById('saved-tab-btn');
            const cartContent = document.getElementById('cart-tab-content');
            const savedContent = document.getElementById('saved-tab-content');

            // Cambio entre pestañas
            cartTabBtn.addEventListener('click', function() {
              cartTabBtn.classList.add('active');
              savedTabBtn.classList.remove('active');
              cartContent.classList.remove('d-none');
              savedContent.classList.add('d-none');
            });

            savedTabBtn.addEventListener('click', function() {
              savedTabBtn.classList.add('active');
              cartTabBtn.classList.remove('active');
              savedContent.classList.remove('d-none');
              cartContent.classList.add('d-none');
            });
          });
        </script>
      </t>
    </xpath>
  </template>
</odoo>