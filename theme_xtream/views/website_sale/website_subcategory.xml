<odoo>
    <template id="website_subcategory" name="Subcategorías con Filtros">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty" style="font-family: 'Questrial', sans-serif;">
                <div class="container-fluid py-4">
                    <div class="row">
                        <!-- Sidebar de Filtros -->
                        <div class="col-lg-3 col-md-4">
                            <div class="filters-sidebar" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4 style="margin-bottom: 20px; color: #333;">Filtros</h4>
                                
                                <!-- Categorías -->
                                <div class="filter-section mb-4">
                                    <h5 style="color: #555; margin-bottom: 15px;">Categorías</h5>
                                    <select id="category-select" class="form-select mb-2" onchange="updateFilters()">
                                        <option value="">Todas las categorías</option>
                                        <t t-foreach="categories" t-as="category" t-key="category.id">
                                            <option t-att-value="category.id" 
                                                    t-att-selected="'selected' if current_filters.get('category_id') == category.id else ''">
                                                <t t-esc="category.name"/>
                                            </option>
                                        </t>
                                    </select>
                                    
                                    <!-- Subcategorías -->
                                    <select id="subcategory-select" class="form-select" onchange="updateFilters()" 
                                            t-att-style="'display: none' if not subcategories else ''">
                                        <option value="">Todas las subcategorías</option>
                                        <t t-foreach="subcategories" t-as="subcategory" t-key="subcategory.id">
                                            <option t-att-value="subcategory.id"
                                                    t-att-selected="'selected' if current_filters.get('subcategory_id') == subcategory.id else ''">
                                                <t t-esc="subcategory.name"/>
                                            </option>
                                        </t>
                                    </select>
                                </div>
                                
                                <!-- Marcas -->
                                <div class="filter-section mb-4">
                                    <h5 style="color: #555; margin-bottom: 15px;">Marcas</h5>
                                    <div id="brands-container">
                                        <t t-foreach="available_brands" t-as="brand" t-key="brand.id">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio" name="brand" 
                                                       t-att-value="brand.id" t-att-id="'brand_' + str(brand.id)"
                                                       t-att-checked="'checked' if current_filters.get('brand_id') == brand.id else ''"
                                                       onchange="updateFilters()"/>
                                                <label class="form-check-label" t-att-for="'brand_' + str(brand.id)">
                                                    <t t-esc="brand.name"/>
                                                    <small class="text-muted">(<t t-esc="brand_counts.get(brand.id, 0)"/>)</small>
                                                </label>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                                
                                <!-- Resto de filtros... -->
                            </div>
                        </div>
                        
                        <!-- Área de Productos -->
                        <div class="col-lg-9 col-md-8">
                            <!-- Breadcrumb y Ordenamiento -->
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <!-- Breadcrumb Navegable -->
                                <div class="breadcrumb-section">
                                    <nav aria-label="breadcrumb">
                                        <ol class="breadcrumb mb-0">
                                            <li class="breadcrumb-item">
                                                <a href="/subcategory" class="text-decoration-none">Productos</a>
                                            </li>
                                            <t t-if="selected_category">
                                                <li class="breadcrumb-item">
                                                    <a t-att-href="'/subcategory?category_id=' + str(selected_category.id)" class="text-decoration-none">
                                                        <t t-esc="selected_category.name"/>
                                                    </a>
                                                </li>
                                            </t>
                                            <t t-if="selected_subcategory">
                                                <li class="breadcrumb-item">
                                                    <a t-att-href="'/subcategory?subcategory_id=' + str(selected_subcategory.id)" class="text-decoration-none">
                                                        <t t-esc="selected_subcategory.name"/>
                                                    </a>
                                                </li>
                                            </t>
                                            <t t-if="selected_brand">
                                                <li class="breadcrumb-item active" aria-current="page">
                                                    <t t-esc="selected_brand.name"/>
                                                </li>
                                            </t>
                                        </ol>
                                    </nav>
                                    <!-- Contador de productos -->
                                    <small class="text-muted">
                                        <t t-esc="product_count"/> producto<t t-if="product_count != 1">s</t> encontrado<t t-if="product_count != 1">s</t>
                                    </small>
                                </div>
                                
                                <!-- Ordenamiento -->
                                <div class="sort-section">
                                    <div class="d-flex align-items-center">
                                        <label class="me-2 mb-0" style="font-size: 0.9rem;">Ordenar por:</label>
                                        <select id="sort-select" class="form-select form-select-sm" style="width: auto; min-width: 180px;" onchange="updateSort()">
                                            <option value="relevance" t-att-selected="'selected' if current_filters.get('sort') == 'relevance' or not current_filters.get('sort') else ''">
                                                Más relevantes (vendidos)
                                            </option>
                                            <option value="newest" t-att-selected="'selected' if current_filters.get('sort') == 'newest' else ''">
                                                Más nuevos
                                            </option>
                                            <option value="best_sellers" t-att-selected="'selected' if current_filters.get('sort') == 'best_sellers' else ''">
                                                Más vendidos
                                            </option>
                                            <option value="offers" t-att-selected="'selected' if current_filters.get('sort') == 'offers' else ''">
                                                Con ofertas
                                            </option>
                                            <option value="price_low" t-att-selected="'selected' if current_filters.get('sort') == 'price_low' else ''">
                                                Precio: menor a mayor
                                            </option>
                                            <option value="price_high" t-att-selected="'selected' if current_filters.get('sort') == 'price_high' else ''">
                                                Precio: mayor a menor
                                            </option>
                                            <option value="alphabetical" t-att-selected="'selected' if current_filters.get('sort') == 'alphabetical' else ''">
                                                A - Z
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Lista de productos -->
                            <div class="products-list">
                                <t t-foreach="period_products" t-as="product_data" t-key="product_data['product'].id">
                                    <div class="product-list-item mb-3 p-3" style="border: 1px solid #dee2e6; border-radius: 8px;">
                                        <div class="row align-items-center">
                                            <!-- Imagen del producto -->
                                            <div class="col-3">
                                                <img t-att-src="'/web/image/product.template/%s/image_1024' % product_data['product'].id" 
                                                     class="img-fluid" alt="Product Image" style="max-height: 150px; object-fit: contain;"/>
                                            </div>
                                            <!-- Detalles del producto -->
                                            <div class="col-6">
                                                <h5 class="mb-2" t-field="product_data['product'].name"/>
                                                <p class="text-muted mb-2" t-field="product_data['product'].description_sale"/>
                                                <div class="text-success" t-if="product_data['product'].is_free_shipping">Envío gratis</div>
                                            </div>
                                            <!-- Precio y descuento -->
                                            <div class="col-3 text-end">
                                                <div t-if="product_data['product'].has_discounted_price" class="text-danger mb-1">
                                                    <span t-esc="product_data['product'].list_price" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                                </div>
                                                <div class="h5 mb-2">
                                                    <span t-esc="product_data['product'].price" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                                </div>
                                                <div t-if="product_data['product'].has_discounted_price" class="badge bg-danger">
                                                    <t t-esc="((product_data['product'].list_price - product_data['product'].price) / product_data['product'].list_price * 100) // 1"/>% OFF
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>