<odoo>
    <template id="website_view_product_xtream" inherit_id="website_sale.product">
        <xpath expr="//div[@id='wrap']" position="replace">
            
            <t t-call-assets="website.assets_frontend" t-js="true"/>
            <t t-call-assets="website_sale.assets_frontend" t-js="true"/>
            <div id="wrap" class="oe_structure oe_website_sale text-center" style="padding: 40px;">
                           <!-- ...existing code... -->
            <div style="background:#D2D2D2; padding:10px 20px; border-radius:6px; margin-bottom:20px; display:flex; align-items:center; gap:10px; justify-content:flex-start;">
                <t t-set="referer" t-value="request.httprequest.headers.get('Referer')"/>
                <t t-if="not referer or referer == request.httprequest.url">
                    <t t-set="referer" t-value="'/subcategory'"/>
                </t>
                <a t-att-href="referer" style="color:#333;">Volver</a>
                <span style="margin: 0 8px;">|</span>
                <span t-if="product.categ_id">
                    <t t-set="parent_cat" t-value="product.categ_id.parent_id"/>
                    <t t-if="parent_cat and parent_cat.parent_id">
                        <!-- Grandparent > Parent > Child -->
                        <a t-att-href="'/subcategory?category_id=%s' % parent_cat.parent_id.id" t-esc="parent_cat.parent_id.name" style="color:#337ab7;"/>
                        <span style="margin: 0 4px;">&gt;</span>
                        <a t-att-href="'/subcategory?category_id=%s' % parent_cat.id" t-esc="parent_cat.name" style="color:#337ab7;"/>
                        <span style="margin: 0 4px;">&gt;</span>
                        <a t-att-href="'/subcategory?category_id=%s' % product.categ_id.id" t-esc="product.categ_id.name" style="color:#337ab7;"/>
                    </t>
                    <t t-elif="parent_cat">
                        <!-- Parent > Child -->
                        <a t-att-href="'/subcategory?category_id=%s' % parent_cat.id" t-esc="parent_cat.name" style="color:#337ab7;"/>
                        <span style="margin: 0 4px;">&gt;</span>
                        <a t-att-href="'/subcategory?category_id=%s' % product.categ_id.id" t-esc="product.categ_id.name" style="color:#337ab7;"/>
                    </t>
                    <t t-else="">
                        <!-- Only Child -->
                        <a t-att-href="'/subcategory?category_id=%s' % product.categ_id.id" t-esc="product.categ_id.name" style="color:#337ab7;"/>
                    </t>
                </span>
            </div>

            <!-- ...resto del contenido (imagen, nombre, etc)... -->
                <div class="row">
                    <!-- Galería de miniaturas a la izquierda (ahora arriba de la imagen principal en mobile, a la izquierda en desktop) -->
                    <div class="col-12 col-md-2 d-flex flex-md-column align-items-center align-items-md-start mb-3 mb-md-0" style="padding-right: 0;">
                        <div class="d-flex flex-row flex-md-column gap-2 align-items-center" id="product-thumbs" style="align-items: flex-start;">
                            <!-- Siempre la imagen principal como primer miniatura -->
                            <img t-att-src="'/web/image/product.template/' + str(product.id) + '/image_1920'"
                                class="img-thumbnail mb-2 product-thumb active thumb-mini"
                                t-att-data-img="'/web/image/product.template/' + str(product.id) + '/image_1920'"
                                style="cursor:pointer;" />
                            <!-- Después, solo las imágenes adicionales -->
                            <t t-if="product.product_image_ids">
                                <t t-foreach="product.product_image_ids" t-as="img">
                                    <img t-att-src="'/web/image/product.image/' + str(img.id) + '/image_1920'"
                                        class="img-thumbnail mb-2 product-thumb thumb-mini"
                                        t-att-data-img="'/web/image/product.image/' + str(img.id) + '/image_1920'"
                                        style="cursor:pointer;" />
                                </t>
                            </t>
                        </div>
                    </div>
                    <!-- Imagen principal al centro, cuadro izquierdo debajo de la imagen principal -->
                    <div class="col-12 col-md-6 d-flex flex-column align-items-center justify-content-start" style="min-height: 100%; padding-top: 0;">
                        <img id="main-product-img"
                            t-att-src="'/web/image/product.template/' + str(product.id) + '/image_1920'"
                            class="img-fluid main-img-large"
                            style="max-height:580px;cursor:pointer; margin-top: 0;"/>
                        <!-- Cuadro izquierdo debajo de la imagen principal, ocupa el ancho de la imagen central y el espacio de las miniaturas -->
                        <div style="background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.07); margin-top: 24px; width: 100%; min-height: 120px; padding: 16px; display: flex; align-items: center; justify-content: center;">
                            <!-- Contenido del cuadro izquierdo -->
                            <span style="color:#888;">Cuadro izquierdo</span>
                        </div>
                    </div>
                    <!-- Cuadro derecho al lado derecho de la imagen principal -->
                    <div class="col-12 col-md-4 d-flex flex-column align-items-center justify-content-start" style="padding-left: 0;">
                        <div style="background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.07); width: 100%; min-height: 160px; padding: 20px; display: flex; align-items: center; justify-content: center;">
                            <!-- Contenido del cuadro derecho -->
                            <span style="color:#888;">Cuadro derecho</span>
                        </div>
                    </div>
                    <script type="text/javascript">
                        document.addEventListener('DOMContentLoaded', function() {
                            var mainImg = document.getElementById('main-product-img');
                            var thumbs = document.querySelectorAll('#product-thumbs .product-thumb');
                            // Cambiar imagen principal al hacer click en miniatura
                            thumbs.forEach(function(thumb) {
                                thumb.addEventListener('click', function() {
                                    mainImg.src = thumb.getAttribute('data-img');
                                    thumbs.forEach(function(t) { t.classList.remove('active'); });
                                    thumb.classList.add('active');
                                });
                            });
                            // Al hacer click en la imagen principal, vuelve a la primera miniatura
                            mainImg.addEventListener('click', function() {
                                var firstThumb = document.querySelector('#product-thumbs .product-thumb');
                                if (firstThumb) {
                                    mainImg.src = firstThumb.getAttribute('data-img');
                                    thumbs.forEach(function(t) { t.classList.remove('active'); });
                                    firstThumb.classList.add('active');
                                }
                            });
                        });
                    </script>
                </div>
            </div> <!-- Cierre de la fila .row -->

            <div id="product_option_block"></div>
            <div id="o_product_terms_and_share"></div>
            
            <t t-jquery="body" t-operation="append">
                <style>
                    .product-thumb.thumb-mini {
                        width: 60px;
                        height: 60px;
                        object-fit: cover;
                        border-radius: 6px;
                    }
                    .main-img-large {
                        max-width: 100%;
                        max-height: 350px;
                        border-radius: 8px;
                        /* box-shadow: 0 2px 8px rgba(0,0,0,0.08); */ /* Eliminado el sombreado */
                    }
                    .product-thumb.active {
                        border: 2px solid #4285f4;
                    }

                    
                </style>
            </t>

        </xpath>
    </template>
</odoo>